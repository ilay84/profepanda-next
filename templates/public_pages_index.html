{% extends "base.html" %}
{% block title %}{{ 'Publicaciones · ProfePanda' if lang == 'es' else 'Posts · ProfePanda' }}{% endblock %}

{% block content %}
<style>
  @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap');
  .wrap{max-width:980px;margin:1.25rem auto 2.5rem;font-family:'Montserrat',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;}
  .head{display:flex;align-items:center;justify-content:space-between;gap:1rem;margin:0 0 1rem;}
  .head h1{margin:0;font-size:clamp(1.6rem,1.2rem + 1vw,2.2rem);font-weight:800;color:#0f172a;}

  .grid{display:grid;grid-template-columns:1fr;gap:12px;}
  @media (min-width:720px){ .grid{grid-template-columns:1fr 1fr;} }

  .item{background:#fff;border:1px solid #e5e7eb;border-radius:14px;padding:1rem 1.1rem;box-shadow:0 6px 18px rgba(0,0,0,.06);}
  .item h2{margin:.1rem 0 .35rem;font-size:1.15rem;}
  .item h2 a{color:#0f172a;text-decoration:none;}
  .item h2 a:hover{color:#2563eb;text-decoration:underline;}
  .meta{display:flex;gap:.5rem;flex-wrap:wrap;align-items:center;color:#64748b;font-size:.92rem;margin:.25rem 0 .6rem;}
  .tag{display:inline-block;padding:.15rem .55rem;border-radius:999px;background:#eef2ff;color:#1e40af;font-weight:600;font-size:.8rem;}

  /* NEW: dual language call-to-action */
  .lang-cta{display:flex;flex-direction:column;align-items:center;gap:.5rem;margin-top:.25rem;}
  .lang-cta a{
    display:block; width:100%; max-width:260px; text-align:center;
    padding:.6rem .9rem; border-radius:12px; font-weight:700; text-decoration:none;
    transition:filter .15s ease, transform .02s ease;
  }
  .lang-cta a:active{ transform:translateY(1px); }
  .lang-cta a.es{ background:#2563eb; color:#fff; }
  .lang-cta a.es:hover{ filter:brightness(.98); }
  .lang-cta a.en{
    background:#f1f5f9; color:#0f172a; border:1px solid #e2e8f0;
  }
  .lang-cta a.en:hover{ filter:brightness(.97); }

  .empty{color:#475569;margin-top:.75rem;}
</style>

<div class="wrap">
  <div class="head">
    <h1>{{ 'Publicaciones' if lang == 'es' else 'Posts' }}</h1>
  </div>

  {% if pages and pages|length > 0 %}
    <div class="grid">
      {% for p in pages %}
      <article class="item">
        <h2><a href="/pages/{{ p.slug }}">{{ p.title_en or p.title_es or p.title }}</a></h2>

        <div class="meta" style="flex-direction:column;align-items:flex-start;">
          {% if p.display_date %}
            <div><strong>{{ 'Actualizado:' if lang == 'es' else 'Updated:' }}</strong> {{ p.display_date }}</div>
          {% endif %}
          {% if p.tags and p.tags|length > 0 %}
            <div style="margin-top:6px; display:flex; flex-wrap:wrap; gap:4px;">
              {% for t in p.tags %}
                <span class="tag">{{ t }}</span>
              {% endfor %}
            </div>
          {% endif %}
        </div>

        <!-- NEW: language selection buttons -->
        <div class="lang-cta">
          <a class="es" href="/pages/{{ p.slug }}?lang=es">Leer en español</a>
          <a class="en" href="/pages/{{ p.slug }}?lang=en">Read in English</a>
        </div>
      </article>
      {% endfor %}
    </div>
  {% else %}
    <p class="empty">{{ 'Aún no hay publicaciones.' if lang == 'es' else 'No posts yet.' }}</p>
  {% endif %}
</div>
{% endblock %}